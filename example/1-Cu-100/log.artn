
#===================================== ARTn based on LAMMPS ========================================
# global control parameters
max_num_events      5                   # Max number of events
min_fire            0                   # use FIRE to do minimization both in push back & push forward
flag_press          1                   # Flag whether the pressure info will be monitored
flag_sadl_press     1                   # Flag whether the sadlle point pressure info will be monitored
random_seed         87932               # Seed for random generator
init_config_id      0                   # ID of the initial stable configuration
flag_push_over      1                   # Flag whether to push over saddle to find another minimum
events_per_atom     0                   # Find designed events per atom, set to 0 to shutoff this method

# activation, harmonic well escape
group_4_activat     artn                # The lammps group ID of the atoms that can be activated
flag_dump_direction 0                   # Use dump direction file as the initial kick direction
random_kick_factor 0                   # Norm of the initial displacement (activation)
cluster_radius      3                   # The radius of the cluster that will be activated
init_step_size      0.1                 # Norm of the initial displacement (activation)
basin_factor        2.4                 # Factor multiplying Increment_Size for leaving the basin
min_num_ksteps      3                   # Min # of k-steps before calling Lanczos
max_perp_move_h     5                   # Max # of perpendicular steps leaving basin
max_iter_basin      20                  # Maximum # of iteration for leaving the basin
increment_size      0.08                # Overall scale for the increment moves
force_th_perp_h     0.2                 # Perpendicular force threshold in harmonic well
eigen_th_well       -1                  # Eigenvalue threshold for leaving basin

# activation, converging to saddle
max_activat_iter    500                 # Maximum # of iteraction to approach the saddle
max_trials          5000                # Maximum # of trials of each atom to find the saddle
fire_lanczos_every  5                   # call lanczos every # fire steps approaching saddle
use_fire            0                   # Use FIRE for perpendicular steps approaching the saddle
para_factor         1                   # Factor use to make parallel force nagative when approaching saddle
eigen_th_fail       0.0001              # Eigen threshold for failure in searching the saddle
force_th_saddle     0.1                 # Force threshold for convergence at saddle point
conv_perp_inc       10                  # The basic steps of max # of perpendicular steps approaching the saddle
max_perp_moves_c    70                  # Maximum # of perpendicular steps approaching the saddle
force_th_perp_sad   0.05                # Perpendicular force threshold approaching saddle point

# confirmation of new found saddle
disp_sad2min_thr    -1                  # Minimum distance between saddle and original minimum
flag_push_back      1                   # Push back the saddle to check its linkage to the start
push_over_saddle    0.5                 # Scale of displacement when pushing over the saddle
max_disp_tol        0.5                 # Tolerance displacement to claim the saddle is linked
max_ener_tol        0.1                 # Tolerance displacement to claim the saddle is linked
flag_relax_sad      0                   # Further relax the newly found saddle via SD algorithm
SD_steps            7                   # Steepest Descent steps before CG minimizationm

# Lanczos related parameters
num_lancz_vec_h     25                  # Num of vectors included in Lanczos for escaping well
num_lancz_vec_c     15                  # Num of vectors included in Lanczos for convergence
del_disp_lancz      0.001               # Step of the numerical derivative of forces in Lanczos
eigen_th_lancz      0.01                # Eigenvalue threshold for Lanczos convergence

# Metropolis
temperature         -0.004              # Temperature for Metropolis algorithm, in eV
atom_disp_thr       0.1                 # Displacement threshold to identify an atom as displaced

# Output related parameters
log_file            log.artn            # File to write ARTn log info; NULL to skip
log_level           1                   # Level of ARTn log ouput: 1, high; 0, low.
sadl_press_file     sadl_press.dat      # File to write ARTn sadl pressure info; NULL to skip
failed_ids          failed_ids.dat      # File to write atom that has reached maximum trials
print_freq          5                   # Print ARTn log ouput frequency, if log_level is 1.
event_list_file     log.event           # File to record the event info; NULL to skip
dump_min_config     min.lammpstrj       # File for atomic dump of stable configurations; NULL to skip
dump_sad_config     sad.lammpstrj       # file for atomic dump of saddle configurations; NULL to skip
dump_event_config   eve.lammpstrj       # file for atomic dump of event configurations; NULL to skip
dump_min_every      1                   # Dump min configuration every # step (if 0, no dump)
dump_sad_every      1                   # Dump sad configuration every # step (if 0, no dump)
dump_event_every    0                   # Dump event process configuration every # step (if 0, no dump)
#====================================================================================================

Minimizing the initial configuration, id = 0 ....
  - Minimizer stop condition  : force tolerance
  - Current (ref) energy (eV) : -6212.089082
  - Temperature   (eV)        : -0.004000
  - Force two-norm final      : 0.000058
  - Pressure tensor           : -7199.15 -7199.15 -0.0390791 5.26759e-12 -1.51702e-11 -2.34238e-12

Attempt 1, new activation centered on atom 1793 with total 5 atoms. 0 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01468   3   3     0    0.38207   -0.34494    0.16429    0.00000    0.10568 8
       5    0.92270   6   6    25    1.50848   -1.48156    0.28370    0.00298    1.32632 95
      10    1.78199   6   6     4    0.84244   -0.70780    0.45687   -0.73092    2.57314 163
      12    1.75514   6   6    25    0.62376   -0.28066    0.55705  -11.24019    3.09035 213
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 12 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    1.63202  11  11    15    0.40099   -0.22300    0.33326  -9.2060   3.1126  0.005 240
       4    1.45790  15  15     3    0.08906    0.00224    0.08903  -0.6248   3.4510  0.999 341
  ----------------------------------------------------------------------------------------------------
  Stage 2 converged at a new saddle after 4 iterations, dE = 1.4579
    The distance between new found saddle and min-0 is 3.44688, > -1, acceptable.
  Stage 3, push back the saddle to confirm if it is linked with min-0
    - Current   energy (eV)     : -6212.089080
    - Reference energy (eV)     : -6212.089082
    - Force two-norm final      : 0.000099
    - Minimizer stop condition  : force tolerance
    - # of force evaluations    : 151
  Stage 3 failed, dr = 2.56123, drmax_atom = 2.55479, tolerance = 0.5, reject the new saddle.

Attempt 2, new activation centered on atom 1793 with total 5 atoms. 0 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01758   3   3     0    0.45988   -0.41870    0.19020    0.00000    0.10681 500
       5    1.10081   6   6     7    1.91991   -1.85959    0.47748   -0.81927    1.42002 569
       6    1.30871   6   6     6    1.79443   -1.66687    0.66448   -5.22922    1.71497 583
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 6 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    0.67576  11  11    15    0.68803    0.37111    0.57936  -6.3420   1.4109 -0.330 610
       3    0.51276  14  14     3    0.06702    0.00094    0.06701  -1.2668   1.3797  0.945 688
  ----------------------------------------------------------------------------------------------------
  Stage 2 converged at a new saddle after 3 iterations, dE = 0.512762
    The distance between new found saddle and min-0 is 1.37186, > -1, acceptable.
  Stage 3, push back the saddle to confirm if it is linked with min-0
    - Current   energy (eV)     : -6212.089066
    - Reference energy (eV)     : -6212.089082
    - Force two-norm final      : 0.000094
    - Minimizer stop condition  : force tolerance
    - # of force evaluations    : 146
  Stage 3 succeeded, dr = 0.00256864, drmax_atom = 0.000241663, tolerance = 0.5, accept the new saddle.
  Stage 4, push over the new saddle, Enew: -6211.71; Eref= -6212.09. Relaxing...
    Relaxed to a nearby minimum to sad-1
    - Current  min  energy (eV) : -6212.089065
    - Force two-norm final      : 0.000087
      - Reference     energy (eV) : -6212.089082
      - Minimizer stop condition  : force tolerance
      - Distance to min-00000000  : 2.56123
  Stage 4 done, the new min (E= -6212.09) of ID 1 is rejected by Metropolis.

Attempt 3, new activation centered on atom 1793 with total 5 atoms. 1 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01849   3   3     0    0.44573   -0.41530    0.16189    0.00000    0.10504 1004
       5    1.32407   6   6    21    2.28818   -2.25757    0.37299   -0.49187    1.30235 1087
       6    1.68835   6   6    12    2.26939   -2.22703    0.43642  -11.65345    1.55165 1107
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 6 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    0.41087  11  11     6    1.05725   -0.75317    0.74197  -5.1763   0.9715  0.286 1125
       2    0.03330  13  13    15    0.17049   -0.02566    0.16854   0.1173   0.4974 -0.017 1216
  ----------------------------------------------------------------------------------------------------
  Stage 2 failed, the smallest eigen value is 0.117291 > 0.0001 or delE = 0.0332996 < -1.0

Attempt 4, new activation centered on atom 1793 with total 5 atoms. 1 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01421   3   3     0    0.37029   -0.33366    0.16058    0.00000    0.10543 1220
       5    1.02256   6   6    25    1.93316   -1.90184    0.34654    0.00487    1.33169 1307
       8    1.90218   6   6     5    1.89924   -1.81428    0.56168   -1.03215    2.12844 1358
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 8 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    0.92136  11  11     3    0.93620    0.29898    0.88718  -1.0370   1.7051 -0.422 1373
       3    0.51783  14  14     3    0.09124   -0.00282    0.09120  -1.3076   1.4236  0.999 1440
  ----------------------------------------------------------------------------------------------------
  Stage 2 converged at a new saddle after 3 iterations, dE = 0.517825
    The distance between new found saddle and min-0 is 1.41186, > -1, acceptable.
  Stage 3, push back the saddle to confirm if it is linked with min-0
    - Current   energy (eV)     : -6212.089082
    - Reference energy (eV)     : -6212.089082
    - Force two-norm final      : 0.000085
    - Minimizer stop condition  : force tolerance
    - # of force evaluations    : 152
  Stage 3 succeeded, dr = 0.000582975, drmax_atom = 5.27296e-05, tolerance = 0.5, accept the new saddle.
  Stage 4, push over the new saddle, Enew: -6211.71; Eref= -6212.09. Relaxing...
    Relaxed to a nearby minimum to sad-2
    - Current  min  energy (eV) : -6212.089080
    - Force two-norm final      : 0.000094
      - Reference     energy (eV) : -6212.089082
      - Minimizer stop condition  : force tolerance
      - Distance to min-00000000  : 2.56123
  Stage 4 done, the new min (E= -6212.09) of ID 2 is rejected by Metropolis.

Attempt 5, new activation centered on atom 1793 with total 5 atoms. 2 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01310   3   3     0    0.36687   -0.32270    0.17451    0.00000    0.10769 1760
       5    0.80405   6   6    25    1.42459   -1.39239    0.30117    0.01138    1.31225 1847
      10    1.66189   6   6     9    1.60896   -1.42471    0.74764   -0.91474    2.63393 1945
      11    1.77183   6   6     4    1.75295   -1.59983    0.71650   -1.18599    2.90983 1957
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 11 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    1.03373  11  11     3    0.96230    0.60994    0.74430  -1.1912   2.6419 -0.238 1972
       5    1.04174   9   9     6    0.16070    0.15365    0.04709  -0.1960   2.9606  0.986 2090
       8    1.09633   9   9     9    0.12380    0.11417    0.04788   0.0841   3.2577  0.980 2171
  ----------------------------------------------------------------------------------------------------
  Stage 2 failed, the smallest eigen value is 0.0840956 > 0.0001 or delE = 1.09633 < -1.0

Attempt 6, new activation centered on atom 1793 with total 5 atoms. 2 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01851   3   3     0    0.45037   -0.41762    0.16861    0.00000    0.10518 2175
       5    0.99789   6   6    15    1.50865   -1.43278    0.47239   -0.84190    1.32132 2252
       6    1.12466   6   6     5    1.41970   -1.24567    0.68108   -1.03964    1.60181 2265
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 6 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    0.60080  11  11     3    0.48652    0.06763    0.48180  -1.0413   1.4091 -0.508 2280
       2    0.51139  13  13     3    0.08161   -0.00299    0.08155  -1.2732   1.3603  1.000 2323
  ----------------------------------------------------------------------------------------------------
  Stage 2 converged at a new saddle after 2 iterations, dE = 0.51139
    The distance between new found saddle and min-0 is 1.35872, > -1, acceptable.
  Stage 3, push back the saddle to confirm if it is linked with min-0
    - Current   energy (eV)     : -6212.089082
    - Reference energy (eV)     : -6212.089082
    - Force two-norm final      : 0.000095
    - Minimizer stop condition  : force tolerance
    - # of force evaluations    : 144
  Stage 3 succeeded, dr = 0.000193736, drmax_atom = 1.51917e-05, tolerance = 0.5, accept the new saddle.
  Stage 4, push over the new saddle, Enew: -6211.72; Eref= -6212.09. Relaxing...
    Relaxed to a nearby minimum to sad-3
    - Current  min  energy (eV) : -6212.089081
    - Force two-norm final      : 0.000095
      - Reference     energy (eV) : -6212.089082
      - Minimizer stop condition  : force tolerance
      - Distance to min-00000000  : 2.56123
  Stage 4 done, the new min (E= -6212.09) of ID 3 is rejected by Metropolis.

Attempt 7, new activation centered on atom 1793 with total 5 atoms. 3 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.02176   3   3     0    0.52203   -0.49129    0.17650    0.00000    0.10559 2633
       5    0.97998   6   6     9    1.63131   -1.54419    0.52596   -0.59672    1.46991 2704
       6    1.11761   6   6     9    1.43722   -1.29909    0.61479   -6.30638    1.76061 2721
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 6 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    0.82292  11  11     5    0.65126   -0.56610    0.32197  -2.8926   1.6493  0.527 2738
       5    0.82117  12  12    15    0.07459   -0.05603    0.04923  -0.1601   2.2975  0.924 2903
  ----------------------------------------------------------------------------------------------------
  Stage 2 converged at a new saddle after 5 iterations, dE = 0.821168
    The distance between new found saddle and min-0 is 2.29699, > -1, acceptable.
  Stage 3, push back the saddle to confirm if it is linked with min-0
    - Current   energy (eV)     : -6212.089073
    - Reference energy (eV)     : -6212.089082
    - Force two-norm final      : 0.000089
    - Minimizer stop condition  : force tolerance
    - # of force evaluations    : 157
  Stage 3 succeeded, dr = 0.00194767, drmax_atom = 0.00019997, tolerance = 0.5, accept the new saddle.
  Stage 4, push over the new saddle, Enew: -6211.26; Eref= -6212.09. Relaxing...
    Relaxed to a nearby minimum to sad-4
    - Current  min  energy (eV) : -6211.282207
    - Force two-norm final      : 0.000097
      - Reference     energy (eV) : -6212.089082
      - Minimizer stop condition  : force tolerance
      - Distance to min-00000000  : 2.70811
  Stage 4 done, the new min (E= -6211.28) of ID 4 is rejected by Metropolis.

Attempt 8, new activation centered on atom 1793 with total 5 atoms. 4 success till now.
  Stage 1, search for the saddle from configuration 0
  ----------------------------------------------------------------------------------------------------
    Steps  E-Eref m_perp trial nlanc ftot       fpar        fperp     eigen       delr   evalf
  ----------------------------------------------------------------------------------------------------
       0    0.01637   3   3     0    0.43267   -0.39385    0.17912    0.00000    0.10763 3258
       5    1.03427   6   6    25    1.80268   -1.74951    0.43459   -0.44880    1.37390 3345
       6    1.25969   6   6    16    1.74253   -1.64015    0.58851  -13.61128    1.65025 3369
  ----------------------------------------------------------------------------------------------------
  Stage 1 succeeded after 6 iterations, continue searching based on eigen-vector.
  Stage 2, converge to the saddle by using Lanczos
  ----------------------------------------------------------------------------------------------------
    Iter   E-Eref m_perp trial nlanc ftot      fpar        fperp     eigen     delr    h.h' evalf
  ----------------------------------------------------------------------------------------------------
       0    0.74353  11  11     9    0.80489   -0.70126    0.39506  -3.2737   1.4376  0.449 3390
       4    0.50996  15  15     3    0.06306   -0.00369    0.06296  -1.2991   1.3582  0.999 3507
  ----------------------------------------------------------------------------------------------------
  Stage 2 converged at a new saddle after 4 iterations, dE = 0.509957
    The distance between new found saddle and min-0 is 1.35669, > -1, acceptable.
  Stage 3, push back the saddle to confirm if it is linked with min-0
    - Current   energy (eV)     : -6212.089081
    - Reference energy (eV)     : -6212.089082
    - Force two-norm final      : 0.000091
    - Minimizer stop condition  : force tolerance
    - # of force evaluations    : 144
  Stage 3 succeeded, dr = 0.000677345, drmax_atom = 6.2432e-05, tolerance = 0.5, accept the new saddle.
  Stage 4, push over the new saddle, Enew: -6211.72; Eref= -6212.09. Relaxing...
    Relaxed to a nearby minimum to sad-5
    - Current  min  energy (eV) : -6212.089080
    - Force two-norm final      : 0.000086
      - Reference     energy (eV) : -6212.089082
      - Minimizer stop condition  : force tolerance
      - Distance to min-00000000  : 2.56123
  Stage 4 done, the new min (E= -6212.09) of ID 5 is rejected by Metropolis.

#=========================================================================================
# Total number of ARTn attempts : 8
# Number of new found saddle    : 6 (75.0% success)
# Number of accepted new saddle : 5 (83.3% acceptance)
# Overall mission success rate  : 62.5%
# Number of new minimumi found  : 5
# Number of accepted minima     : 0 (0% acceptance)
# Number of force evaluation    : 3815
#=========================================================================================
